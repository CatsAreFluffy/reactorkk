<html><head></head><body onload="run()">
<span id="bux">Money: $10</span>
<span id="power">Power: 0/100</span>
<button onclick="sellpower()">Sell!</button>
<span id="heat">Heat: 0/1000</span> <button onclick="heat-=1">-1 Heat</button><br>
<button onclick="togglePause()" id="pause">Pause</button><button onclick="togglePerpetual()" id="perpetual">Disable perpetual cells</button><br>
Objective: <span id="objective">Place a cell ($10)</span><br>
<button onclick="prevType()">&lt;</button>
<button onclick="nextType()">&gt;</button>
<span id="type">Cells</span><br>
<button onclick="prevItem()">&lt;</button>
<button onclick="nextItem()">&gt;</button>
<span id="item">Uranium Cell (Click the grid!)</span><br>
<div id="tooltip">Generates 1 power and 1 heat per tick for 15 ticks.</div>
<canvas id="game" width=450 height=450 style="border:1px solid #000000;">
You can't run the game :( ^ Update your browser to play ^
</canvas>
<ul>
<li>Potent Uranium <span id="potent0v">0</span> <button id="potent0" onclick="buyPotent(0)">$500</button></li>
<li>Perpetual Uranium <span id="perpetual0v">0</span> <button id="perpetual0" onclick="buyPerpetual(0)">$1000</button></li>
<li>Potent Plutonium <span id="potent1v">0</span> <button id="potent1" onclick="buyPotent(1)">$300000</button></li>
<li>Perpetual Plutonium <span id="perpetual1v">0</span> <button id="perpetual1" onclick="buyPerpetual(1)">$600000</button></li>
<li>Improved Powerlines <span id="generic0v">0</span> <button id="generic0" onclick="buyGeneric(0)">$100</button></li>
<li>Improved Vents <span id="generic1v">0</span> <button id="generic1" onclick="buyGeneric(1)">$250</button></li>
<li>Improved Heat Transfer <span id="generic2v">0</span> <button id="generic2" onclick="buyGeneric(2)">$600</button></li>
</ul>
<br>
Play the <a href="https://cwmonkey.github.io/reactor-knockoff/">original</a>, the <a href="http://www.kongregate.com/games/cael/reactor-incremental">double original</a>, the <a href="https://minecraft.curseforge.com/projects/industrial-craft/files">triple orignal</a>, or the <a href="http://www.kongregate.com/games/Baldurans/reactor-idle">alternate triple orginal</a>.
<button onclick="updateBux(1e303)">Cheat</button>
<script>
function run(){
    window.canvas=document.getElementById("game")
    window.canvasleft=canvas.offsetLeft
    window.canvastop=canvas.offsetTop
    window.context=canvas.getContext("2d")
    resetValues(3)
    window.item=0
    window.type=0
    window.autosell=0
    window.reactor=[]
    for(var i=0;i<=canvas.width/30;i++){
        reactor.push([])
        for(var j=0;j<=canvas.width/30;j++){
            reactor[reactor.length-1].push({type:"empty",explosion:0})
        }
    }
    window.perpetual=true
    window.run=true
    window.tick=setInterval(income,500)
    window.objective=0
    window.objectives=["Place a cell ($10)","Sell your power ($10)","Reduce your heat to 0 ($10)","Place a vent next to a cell ($50)","All objectives completed! (for now...)"]
    window.rewards=[10,10,10,50,10000000000]
    canvas.onclick=click
    canvas.oncontextmenu=rclick
    drawGrid()
    context.stroke()
    loadImages()
    unpause()
}
function resetValues(tier){
    //every tick
    window.maxpower=100
    window.buxpertick=0
    if(tier>0){ //I forgot
        window.bux=10
        window.power=0
        window.heat=0
    }
    if(tier>1){ //reboot
        window.items=[
        [
        {name:"uranium1",gname:"Uranium Cell ($10)",cost:10,default:{type:"cell",image:"uranium1",income:1,heat:1,power:15,capacity:0,pulses:1,pulse:0,sell:0,tier:1,name:"uranium1",replacecost:10}},
        {name:"uranium2",gname:"Dual Uranium Cell ($25)",cost:25,default:{type:"cell",image:"uranium2",income:4,heat:8,power:15,capacity:0,pulses:2,pulse:0,sell:0,tier:1,name:"uranium2",replacecost:25}},
        {name:"uranium4",gname:"Quad Uranium Cell ($60)",cost:60,default:{type:"cell",image:"uranium4",income:12,heat:36,power:15,capacity:0,pulses:4,pulse:0,sell:0,tier:1,id:2,name:"uranium4",replacecost:60}},
        {name:"uranium8",gname:"Octo Uranium Cell ($140)",cost:140,default:{type:"cell",image:"uranium8",income:32,heat:128,power:15,capacity:0,pulses:8,pulse:0,sell:0,tier:1,id:3,name:"uranium8",replacecost:140}},
        {name:"plutonium1",gname:"Plutonium Cell ($6K)",cost:6000,default:{type:"cell",image:"plutonium1",income:150,heat:150,power:60,capacity:0,pulses:1,pulse:0,sell:0,tier:2,id:4,name:"plutonium1",replacecost:500}},
        {name:"plutonium2",gname:"Dual Plutonium Cell ($15K)",cost:15000,default:{type:"cell",image:"plutonium2",income:300,heat:600,power:60,capacity:0,pulses:2,pulse:0,sell:0,tier:2,id:5,name:"plutonium2",replacecost:1250}},
        {name:"plutonium4",gname:"Quad Plutonium Cell ($36K)",cost:36000,default:{type:"cell",image:"plutonium4",income:1200,heat:5400,power:60,capacity:0,pulses:4,pulse:0,sell:0,tier:2,id:6,name:"plutonium4",replacecost:3000}},
        {name:"plutonium8",gname:"Octo Plutonium Cell ($84K)",cost:84000,default:{type:"cell",image:"plutonium8",income:4800,heat:19200,power:60,capacity:0,pulses:8,pulse:0,sell:0,tier:2,id:7,name:"plutonium8",replacecost:7000}}
        ],[
        {name:"vent1",gname:"Basic Vent ($50)",cost:50,default:{type:"vent",image:"vent1",capacity:40,vent:4,heat:0,sell:50,tier:1}},
        {name:"vent2",gname:"Advanced Vent ($12.5K)",cost:12500,default:{type:"vent",image:"vent2",capacity:3000,vent:300,heat:0,sell:1000,tier:2}},
        {name:"vent3",gname:"Super Vent ($3.125M)",cost:3125000,default:{type:"vent",image:"vent3",capacity:225000,vent:22500,heat:0,sell:20000,tier:3}},
        ],[
        {name:"outlet1",gname:"Basic Outlet ($160)",cost:160,default:{type:"outlet",image:"outlet1",out:4,capacity:0,sell:160,tier:1}},
        {name:"outlet2",gname:"Advanced Outlet ($32K)",cost:32000,default:{type:"outlet",image:"outlet2",out:300,capacity:0,sell:32000,tier:2}},
        {name:"inlet1",gname:"Basic Inlet ($160)",cost:160,default:{type:"inlet",image:"inlet1",in:4,capacity:0,sell:160,tier:1}},
        {name:"inlet2",gname:"Advanced Inlet ($32K)",cost:32000,default:{type:"inlet",image:"inlet2",in:300,capacity:0,sell:32000,tier:2}}
        ],[
        {name:"cap1",gname:"Basic Capacitor ($1K)",cost:1000,default:{type:"capacitor",image:"cap1",power:100,capacity:10,heat:0,sell:1000,tier:1}},
        {name:"cap1",gname:"Advanced Capacitor ($160K)",cost:160000,default:{type:"capacitor",image:"cap2",power:14000,capacity:50,heat:0,sell:1000,tier:1}}
        ]]
        window.types=["Cells","Vents","In/Outlets","Capacitors"]
        window.itemstable={
        uranium1:0,uranium2:1,uranium4:2,uranium8:3,
        plutonium1:4,plutonium2:5,plutonium4:6,plutonium8:7,
        thorium1:8,thorium2:9,thorium4:10,thorium8:11}
        window.upgrades={potent:[0,0],perpetual:[0,0],generic:[0,0,0]}
    }
    if(tier>2){ //restart game
        window.tooltips={
        cell:function(cell){return "Generates "+cell.income+" power and "+cell.heat+" heat per tick for "+cell.power+" ticks."},
        vent:function(vent){return "Vents "+vent.vent+" heat per tick. Holds "+vent.capacity+" heat."},
        capacitor:function(cap){return "Holds "+cap.power+" power and "+cap.capacity+" heat."},
        outlet:function(out){return "Adds "+out.out+" heat to adjacent components."},
        inlet:function(inlet){return "Removes "+inlet.in+" heat from adjacent components."}
        }
        window.cellcosts=[10,6000]
        window.genericcosts=[100,250,600] //powerlines,vents,ioutlets
    }
}
function drawGrid(){
    context.beginPath()
    for(var i=30;i<canvas.width;i+=30){
        context.moveTo(i,0)
        context.lineTo(i,canvas.height)
    }
    for(var i=30;i<canvas.height;i+=30){
        context.moveTo(0,i)
        context.lineTo(canvas.width,i)
    }
}
function loadImages(){
    var images=["uranium1","uranium1d","uranium2","uranium2d","uranium4","uranium4d","uranium8","uranium8d","plutonium1","plutonium1d","plutonium2","plutonium2d","plutonium4","plutonium4d","plutonium8","plutonium8d","vent1","vent2","vent3","outlet1","outlet2","inlet1","inlet2","cap1","cap2","boom"]
    for(var i=0;i<images.length;i++){
        window[images[i]+"img"]=new Image()
        window[images[i]+"img"].src="./"+images[i]+".png"
    }
}
function click(event){
    if(event.shiftKey){
        replaceall(event)
    }else{
        buy(event)
    }
} 
function rclick(event){
    sell(event)
    return false
}
function buy(event){
    var x=event.pageX-canvasleft
    var y=event.pageY-canvastop
    var ioffset=18
    var ooffset=3
    var scale=30
    x=(x-ioffset)/scale;y=(y-ioffset)/scale
    x=Math.round(x);y=Math.round(y)
    gridx=x;gridy=y
    x=x*scale+ooffset;y=y*scale+ooffset
    var object=currentItem()
    var cell=reactor[gridx][gridy]
    switch(cell.type){
        case "empty":
            buyitem(object,x,y,gridx,gridy)
            break;
        case "dcell":
            buyitem(items[0][itemstable[cell.name]],x,y,gridx,gridy)
        break;
    }
}
function buyitem(object,x,y,gridx,gridy){
    if(bux>=object.cost){
        reactor[gridx][gridy]=Object.assign({drawx:x,drawy:y},object.default)
        updateBux(-object.cost)
        updateAll()
    }
}
function sellitem(x,y){
    if(reactor[x][y].type!="empty"){
        updateBux(reactor[x][y].sell)
        reactor[x][y]={type:"empty",explosion:0}
    }
}
function replaceall(event){
    var x=event.pageX-canvasleft
    var y=event.pageY-canvastop
    var ioffset=18
    var ooffset=3
    var scale=30
    x=(x-ioffset)/scale;y=(y-ioffset)/scale
    x=Math.round(x);y=Math.round(y)
    gridx=x;gridy=y
    x=x*scale+ooffset;y=y*scale+ooffset
    var image=reactor[gridx][gridy].image
    for(var i=0;i<reactor.length;i++){
        for(var j=0;j<reactor[i].length;j++){
            var cell=reactor[i][j]
            if(cell.image==image&&cell.type=="dcell"){
                buyitem(items[0][itemstable[cell.name]],cell.drawx,cell.drawy,i,j)
            }else if(cell.image==image){
                buyitem(currentItem(),cell.drawx,cell.drawy,i,j)
            }
        }
    }
}
function sell(event){
    var x=event.pageX-canvasleft
    var y=event.pageY-canvastop
    var ioffset=18
    var ooffset=3
    var scale=30
    x=(x-ioffset)/scale;y=(y-ioffset)/scale
    x=Math.round(x);y=Math.round(y)
    gridx=x;gridy=y
    x=x*scale+ooffset;y=y*scale+ooffset
    var cell=reactor[gridx][gridy]
    if(cell.type!="empty"){
        sellitem(gridx,gridy)
    }
}
function sellpower(){
    updateBux(power)
    updatePower(-power)
}
function nextItem(){
    item+=1
    item%=items[type].length
    updateItem(item)
}
function prevItem(){
    if(!item){item=items[type].length}
    item-=1
    updateItem(item)
}
function nextType(){
    type+=1
    type%=types.length
    item%=items[type].length
    updateType(type)
}
function prevType(){
    if(!type){type=types.length}
    type-=1
    item%=items[type].length
    updateType(type)
}
function togglePerpetual(){
    perpetual=!perpetual
    if(perpetual){
        update("perpetual","Disable perpetual cells")
    }else{
        update("perpetual","Enable perpetual cells")
    }
}
function togglePause(){
    if(!run){
        unpause()
    }else{
        pause()
    }
}
function pause(){
    run=false
    update("pause","Unpause")
}
function unpause(){
    run=true
    update("pause","Pause")
}
function income(){
    buxpertick=0
    context.clearRect(0, 0, canvas.width, canvas.height)
    buxpertick=0
    if(run){
        for(var i=0;i<reactor.length;i++){ //pulses tick
            for(var j=0;j<reactor[i].length;j++){
                cell=reactor[i][j]
                switch(cell.type){
                    case "cell":
                        addpulse(i,j,cell.pulses)
                        break;
                    default:
                        break;
                }
            }
        }
        for(var i=0;i<reactor.length;i++){ //heat plus tick
            for(var j=0;j<reactor[i].length;j++){
                cell=reactor[i][j]
                switch(cell.type){
                    case "cell":
                        addheat(i,j,cell.heat*Math.pow(cell.pulse+1,2),false)
                        break;
                    case "outlet":
                        addheat(i,j,Math.min(cell.out*(upgrades.generic[2]+1),heat),true)
                        console.log(Math.min(cell.out*(upgrades.generic[2]+1),heat))
                        heat-=Math.min(cell.out*(upgrades.generic[2]+1),heat)
                    default:
                        break;
                }
            }
        }
        for(var i=0;i<reactor.length;i++){ //heat minus tick
            for(var j=0;j<reactor[i].length;j++){
                cell=reactor[i][j]
                switch(cell.type){
                    case "vent":
                        cell.heat-=cell.vent*(upgrades.generic[1]+1)
                        if(cell.heat<0){cell.heat=0}
                        break;
                    case "inlet":
                        heat+=removeheat(i,j,cell.in*(upgrades.generic[2]+1),true)
                    default:
                        break;
                }
            }
        }
        for(var i=0;i<reactor.length;i++){ //action tick
            for(var j=0;j<reactor[i].length;j++){
                cell=reactor[i][j]
                switch(cell.type){
                    case "empty":
                        if(cell.explosion>0){reactor[i][j].explosion--;context.drawImage(boomimg,cell.drawx,cell.drawy)}
                    break;
                    case "cell":
                        context.drawImage(window[cell.image+"img"],cell.drawx,cell.drawy)
                        buxpertick+=cell.income*(upgrades.potent[cell.tier-1]+1)*(cell.pulse+1)
                        cell.pulse=0
                        cell.power--
                        if(!cell.power){
                            cell.type="dcell";cell.image+="d"
                            if(upgrades.perpetual[cell.tier-1]&&perpetual){
                                buyitem(items[0][itemstable[cell.name]],cell.drawx,cell.drawy,i,j)
                            }
                        }
                        break;
                    case "vent":
                        context.drawImage(window[cell.image+"img"],cell.drawx,cell.drawy)
                        if(cell.heat>cell.capacity){
                            reactor[i][j]={type:"empty",explosion:4,drawx:cell.drawx,drawy:cell.drawy}
                        }
                        break;
                    case "capacitor":
                        context.drawImage(window[cell.image+"img"],cell.drawx,cell.drawy)
                        if(cell.heat>cell.capacity){
                            reactor[i][j]={type:"empty",explosion:4,drawx:cell.drawx,drawy:cell.drawy}
                        }
                        break;
                    default:
                        context.drawImage(window[cell.image+"img"],cell.drawx,cell.drawy)
                }
                if(heat>2000&&cell.type!="empty"){reactor[i][j]={type:"empty",explosion:4,drawx:cell.drawx,drawy:cell.drawy}}
            }
        }
        updateBux(Math.min(autosell,power))
        updatePower(-Math.min(autosell,power))
        updateHeat(Math.min((1000-heat)/50,-0.1))
    }
    maxpower=100
    for(var i=0;i<reactor.length;i++){ //render/capacity tick
        for(var j=0;j<reactor[i].length;j++){
            cell=reactor[i][j]
            if(cell.type!="empty"){
                context.drawImage(window[cell.image+"img"],cell.drawx,cell.drawy)
            }
            if(cell.type=="capacitor"){
                maxpower+=cell.power
            }
        }
    }
    drawGrid()
    context.stroke()
    updatePower(buxpertick)
    window.autosell=maxpower/100*upgrades.generic[0]
    checkObjectives()
}
function update(thing,value){
    document.getElementById(thing).innerHTML=value
}
function updateBux(amount){
    bux+=amount
    update("bux","Money: $"+bux)
}
function updatePower(amount){
    power+=amount
    if(power>maxpower){power=maxpower}
    update("power","Power: "+power+"/"+maxpower)
}
function updateHeat(amount){
    heat+=amount
    clampheat()
    update("heat","Heat: "+heat+"/1000")
}
function updateItem(item){
    update("item",currentItem().gname)
    update("tooltip",tooltips[currentItem().default.type].call(null,currentItem().default))
}
function updateType(type){
    update("type",types[type])
    updateItem(item)
}
function updateAll(){
    updatePower(0)
    updateHeat(0)
    updateBux(0)
    updateItem(item)
    updateType(type)
}
function currentItem(){
    return items[type][item]
}
function addheat(x,y,heat,peritem){
    var cells=[]
    if(x>0){cells.push(reactor[x-1][y])}
    if(y>0){cells.push(reactor[x][y-1])}
    if(x<reactor.length-1){cells.push(reactor[x+1][y])}
    if(y<reactor[0].length-1){cells.push(reactor[x][y+1])}
    var heatcells=[]
    for(var i=0;i<cells.length;i++){
        if(cells[i].capacity>0){heatcells.push(cells[i])}
    }
    if(heatcells.length){
        for(var i=0;i<heatcells.length;i++){
            heatcells[i].heat+=(peritem?heat:heat/heatcells.length)
        }
    }else{
        updateHeat(heat)
    }
}
function addpulse(x,y,heat){
    var cells=[]
    if(x>0){cells.push(reactor[x-1][y])}
    if(y>0){cells.push(reactor[x][y-1])}
    if(x<reactor.length-1){cells.push(reactor[x+1][y])}
    if(y<reactor[0].length-1){cells.push(reactor[x][y+1])}
    var heatcells=[]
    for(var i=0;i<cells.length;i++){
        if(cells[i].type=="cell"){heatcells.push(cells[i])}
    }
    if(heatcells.length){
        for(var i=0;i<heatcells.length;i++){
            heatcells[i].pulse++
        }
    }else{
        //...nothing? k
    }
}
function removeheat(x,y,maxheat,peritem){
    var cells=[]
    if(x>0){cells.push(reactor[x-1][y])}
    if(y>0){cells.push(reactor[x][y-1])}
    if(x<reactor.length-1){cells.push(reactor[x+1][y])}
    if(y<reactor[0].length-1){cells.push(reactor[x][y+1])}
    var heatcells=[]
    for(var i=0;i<cells.length;i++){
        if(cells[i].capacity>0){heatcells.push(cells[i])}
    }
    if(heatcells.length){
        var pullheat=0
        for(i=0;i<heatcells.length;i++){
            pullheat+=Math.min(heatcells[i].heat,maxheat)
            heatcells[i].heat-=Math.min(heatcells[i].heat,peritem?maxheat:maxheat/heatcells.length)
        }
    }else{
        var pullheat=0
    }
    return pullheat
}
function clampheat(){
    if(heat<0){heat=0}
    heat=Math.round(heat*10)/10
}
function buyPotent(tier){
    if(bux>cellcosts[tier]*50*Math.pow(10,upgrades.potent[tier])){
        updateBux(-(cellcosts[tier]*50*Math.pow(10,upgrades.potent[tier])))
        upgrades.potent[tier]++
        update("potent"+tier,"$"+cellcosts[tier]*50*Math.pow(10,upgrades.potent[tier]))
        update("potent"+tier+"v",upgrades.potent[tier])
    }
}
function buyPerpetual(tier){
    if(bux>cellcosts[tier]*100&&!upgrades.perpetual(tier)){
        updateBux(-(cellcosts[tier]*100))
        upgrades.perpetual[tier]++
        update("perpetual"+tier,"Purchased")
        update("perpetual"+tier+"v",upgrades.perpetual[tier])
    }
}
function buyGeneric(upgrade){
    if(bux>Math.pow(genericcosts[upgrade],upgrades.generic[upgrade])){
        updateBux(-Math.pow(genericcosts[upgrade],upgrades.generic[upgrade]))
        upgrades.generic[upgrade]++
        update("generic"+upgrade,"$"+genericcosts[upgrade]*Math.pow(10,upgrades.generic[upgrade]))
        update("generic"+upgrade+"v",upgrades.generic[upgrade])
    }
}
function upgrade(x){
    switch(x.type){
        case "cell":
            x.income*=(upgrades.potent[x.tier-1]+1)
            break;
        default:
            break;
    }
    return x
}
function checkObjectives(){
    var complete=false
    switch(objective){
        case 0:
            complete=checkFor("uranium1")
            break;
        case 1:
            complete=power<3&&bux>10
            break;
        case 2:
            complete=heat==0
            break;
        case 3:
            complete=checkFor("vent1")
            break;
        default:
            complete=false //maybe later :P
            break;
    }
    if(complete){
        updateBux(rewards[objective])
        objective++
        update("objective",objectives[objective])
    }
    return complete
}
function checkFor(image){
    for(var i=0;i<reactor.length;i++){
        for(var j=0;j<reactor.length;j++){
            if(reactor[i][j].image==image){return true}
        }
    }
    return false;
}
</script>

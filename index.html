<html><head></head><body onload="run()">
<span id="info">
<span id="bux">Money: $10</span>
<span id="power">Power: 0/100</span>
<button onclick="sellpower()">Sell!</button>
<span id="heat">Heat: 0/1000</span> <button onclick="updateHeat(-1)">-1 Heat</button>
<span id="ep">EP: 0/0/0</span><br>
<button onclick="togglePause()" id="pause">Pause</button><button onclick="togglePerpetual()" id="perpetual">Disable perpetual cells</button><br>
Objective: <span id="objective">Place a cell ($10)</span><br>
<button onclick="prevType()">&lt;</button>
<button onclick="nextType()">&gt;</button>
<span id="type">Cells</span><br>
<button onclick="prevItem()">&lt;</button>
<button onclick="nextItem()">&gt;</button>
<span id="item">Uranium Cell (Click the grid!)</span><br>
<div id="tooltip">Generates 1 power and 1 heat per tick for 15 ticks.</div>
</span>
<h2>Reactor</h2>
<span id="reactor" style="float: left; padding-right: 10px">
<canvas id="game" width=450 height=450 style="border:1px solid #000000;">
You can't run the game :( ^ Update your browser to play ^
</canvas><br>
Click to:
<ul>
<li><button id="mode0" onclick="mode=buy;clickmode(0)" disabled=true>Buy item</button></li>
<li><button id="mode1" onclick="mode=replaceall;clickmode(1)">Replace all of type</button></li>
<li><button id="mode2" onclick="mode=sell;clickmode(2)">Sell item</button></li>
<li><button id="mode3" onclick="mode=sellall;clickmode(3)">Sell all of type</button></li>
</ul>
</span>
<span id="upgrades" style="float: left;">
<h3>Upgrades</h3>
<ul>
<li>Potent Uranium <span id="potent0v">0</span> <button id="potent0" onclick="buyPotent(0)">$500</button> Increase the power output of Uranium cells.</li>
<li>Perpetual Uranium <span id="perpetual0v">0</span> <button id="perpetual0" onclick="buyPerpetual(0)">$1000</button> Make Uranium cells autoreplace.</li>
<li>Potent Plutonium <span id="potent1v">0</span> <button id="potent1" onclick="buyPotent(1)">$300K</button> Increase the power output of Plutonium cells.</li>
<li>Perpetual Plutonium <span id="perpetual1v">0</span> <button id="perpetual1" onclick="buyPerpetual(1)">$600K</button> Make Plutonium cells autoreplace.</li>
<li>Potent Thorium <span id="potent2v">0</span> <button id="potent2" onclick="buyPotent(2)">$180M</button> Increase the power output of Thorium cells.</li>
<li>Perpetual Thorium <span id="perpetual2v">0</span> <button id="perpetual2" onclick="buyPerpetual(2)">$360M</button> Make Thorium cells autoreplace.</li>
<li>Potent Seaborgium <span id="potent3v">0</span> <button id="potent3" onclick="buyPotent(3)">$108B</button> Increase the power output of Seaborgium cells.</li>
<li>Perpetual Seaborgium <span id="perpetual3v">0</span> <button id="perpetual3" onclick="buyPerpetual(3)">$216B</button> Make Seaborgium cells autoreplace.</li>

<li>Potent Dolorium <span id="potent4v">0</span> <button id="potent4" onclick="buyPotent(4)">$64.8T</button> Increase the power output of Dolorium cells.</li>
<li>Perpetual Dolorium <span id="perpetual4v">0</span> <button id="perpetual4" onclick="buyPerpetual(4)">$129.6T</button> Make Dolorium cells autoreplace.</li>
<li>Potent Nefastium <span id="potent5v">0</span> <button id="potent5" onclick="buyPotent(5)">$38.88Qa</button> Increase the power output of Nefastium cells.</li>
<li>Perpetual Nefastium <span id="perpetual5v">0</span> <button id="perpetual5" onclick="buyPerpetual(5)">$77.76Qa</button> Make Nefastium cells autoreplace.</li>

<li>Improved Powerlines <span id="generic0v">0</span> <button id="generic0" onclick="buyGeneric(0)">$100</button> Autosell (level)/100 of your power capacity.</li>
<li>Improved Wiring <span id="generic3v">0</span> <button id="generic3" onclick="buyGeneric(3)">$1000</button> Increase capacitor's capacity</li>
<li>Improved Vents <span id="generic1v">0</span> <button id="generic1" onclick="buyGeneric(1)">$250</button> Increase the venting of your vents.</li>
<li>Improved Heat Transfer <span id="generic2v">0</span> <button id="generic2" onclick="buyGeneric(2)">$600</button> Increase the transfer rate of inlets and outlets.</li>
<li>Active Venting <span id="generic4v">0</span> <button id="generic4" onclick="buyGeneric(4)">$1000</button> Capacitors boost the strength of vents, inlets, and outlets.</li>
</ul>

<h3>EP Upgrades</h3>
<ul>
<li>Unleashed Cells <span id="ep0v">0</span> <button id="ep0" onclick="buyEP(0)">100 EP</button> Double the power and heat of all cells.</li>
<li>Infused Cells <span id="ep1v">0</span> <button id="ep1" onclick="buyEP(1)">50 EP</button> Increase the power of cells.</li>
<li>Fluid Hyperdynamics <span id="ep2v">0</span> <button id="ep2" onclick="buyEP(2)">50 EP</button> Double the power and capacity of vents.</li>
<li>Fractal Piping <span id="ep3v">0</span> <button id="ep3" onclick="buyEP(3)">50 EP</button> Double the power of in/outlets.</li>

<li>Protium Cells <span id="unlock0v">0</span> <button id="unlock0" onclick="buyCellType(0)">50 EP</button> Unlock Protium cells which increase in power when they expire.</li>
</ul>

</span>
<span id="options" style="float: left;">
<br>
Play the <a href="https://cwmonkey.github.io/reactor-knockoff/">original</a>, the <a href="http://www.kongregate.com/games/cael/reactor-incremental">double original</a>, the <a href="https://minecraft.curseforge.com/projects/industrial-craft/files">triple orignal</a>, or the <a href="http://www.kongregate.com/games/Baldurans/reactor-idle">alternate triple orginal</a>.
<button onclick="updateBux(1.79e308)">Cheat (Please be careful)</button><button onclick="aep+=1.79e308;updateEP(0)">Hack (Please be carefuler)</button><br><br>
<button onclick="reboot()">Reboot</button><br><br>
<h3>Options</h3>
<ul>
<li> Always replace depleted cells <button id="options0" onclick="setOption(0)">Yes</button></li>
<li> Quick replace between types <button id="options1" onclick="setOption(1)">No</button></li>
</ul>
<button id="save" onclick="save()">Save</button><button id="load" onclick="load()">Load</button><br>
<textarea id="savefile" style="width: 250; height: 100;">Paste your save code here</textarea><br>
Reactor Knockoff Knockoff 0.6 beta 1
</span>
<script>
function run(){
    window.canvas=document.getElementById("game")
    window.canvasleft=canvas.offsetLeft
    window.canvastop=canvas.offsetTop
    window.context=canvas.getContext("2d")
    resetValues(3)
    window.item=0
    window.type=0
    window.autosell=0
    window.perpetual=true
    window.run=true
    window.tick=setInterval(income,500)
    window.objective=0
    window.objectives=["Place a cell ($10)","Sell your power ($10)","Reduce your heat to 0 ($10)","Place a vent next to a cell ($50)","Buy an upgrade ($100)","Generate 50 power per tick ($250)","Buy a Perpetual upgrade ($500)","Generate 200 power per tick ($1000)","Place a Plutonium cell ($2500)","Generate 1000 power per tick ($10K)","Buy Improved Vents level 3 ($15K)","Autosell 1000 power per tick ($20K)","Place a Thorium cell ($50K)","All objectives completed! (for now...)"]
    window.tracker={boughtitem:0,soldpower:0,zeroheat:0,boughtvent:0,upgraded:0,perpetual:0,maxcelltier:0}
    window.rewards=[10,10,10,50,100,250,500,1000,2500,10000,15000,20000,50000,1.79e308]
    window.selector=[0,0,0,0,0,0,0,0]
    window.exactplz=false
    window.mode=buy
    window.options=[true,false] //replace cells with shiftclick, shiftclick between types
    canvas.onclick=click
    canvas.oncontextmenu=rclick
    drawGrid()
    context.stroke()
    loadImages()
    unpause()
}
function resetValues(tier){
    //every tick
    window.maxpower=100
    window.maxheat=1000
    window.buxpertick=0
    window.capboost=0
    if(tier>0){ //I forgot
        window.bux=10
        window.power=0
        window.heat=0
        window.ep=0
    }
    if(tier>1){ //reboot
        window.items=[
        [
        {name:"uranium1",gname:"Uranium Cell ($10)",cost:10,default:{type:"cell",image:"uranium1",income:1,heat:1,power:15,capacity:0,pulses:1,pulse:0,sell:0,tier:1,name:"uranium1",replacecost:10}},
        {name:"uranium2",gname:"Dual Uranium Cell ($25)",cost:25,default:{type:"cell",image:"uranium2",income:4,heat:8,power:15,capacity:0,pulses:2,pulse:0,sell:0,tier:1,name:"uranium2",replacecost:25}},
        {name:"uranium4",gname:"Quad Uranium Cell ($60)",cost:60,default:{type:"cell",image:"uranium4",income:12,heat:36,power:15,capacity:0,pulses:4,pulse:0,sell:0,tier:1,id:2,name:"uranium4",replacecost:60}},
        {name:"uranium8",gname:"Octo Uranium Cell ($140)",cost:140,default:{type:"cell",image:"uranium8",income:32,heat:128,power:15,capacity:0,pulses:8,pulse:0,sell:0,tier:1,id:3,name:"uranium8",replacecost:140}},
        {name:"plutonium1",gname:"Plutonium Cell ($6000)",cost:6000,default:{type:"cell",image:"plutonium1",income:150,heat:150,power:60,capacity:0,pulses:1,pulse:0,sell:0,tier:2,id:4,name:"plutonium1",replacecost:6000}},
        {name:"plutonium2",gname:"Dual Plutonium Cell ($15K)",cost:15000,default:{type:"cell",image:"plutonium2",income:600,heat:1200,power:60,capacity:0,pulses:2,pulse:0,sell:0,tier:2,id:5,name:"plutonium2",replacecost:15000}},
        {name:"plutonium4",gname:"Quad Plutonium Cell ($36K)",cost:36000,default:{type:"cell",image:"plutonium4",income:1200,heat:5400,power:60,capacity:0,pulses:4,pulse:0,sell:0,tier:2,id:6,name:"plutonium4",replacecost:36000}},
        {name:"plutonium8",gname:"Octo Plutonium Cell ($84K)",cost:84000,default:{type:"cell",image:"plutonium8",income:4800,heat:19200,power:60,capacity:0,pulses:8,pulse:0,sell:0,tier:2,id:7,name:"plutonium8",replacecost:84000}},
        {name:"thorium1",gname:"Thorium Cell ($3600K)",cost:3600000,default:{type:"cell",image:"thorium1",income:22500,heat:22500,power:240,capacity:0,pulses:1,pulse:0,sell:0,tier:3,id:8,name:"thorium1",replacecost:3600000}},
        {name:"thorium2",gname:"Dual Thorium Cell ($9000K)",cost:9000000,default:{type:"cell",image:"thorium2",income:90000,heat:180000,power:240,capacity:0,pulses:2,pulse:0,sell:0,tier:3,id:9,name:"thorium2",replacecost:9000000}},
        {name:"thorium4",gname:"Quad Thorium Cell ($21.6M)",cost:21600000,default:{type:"cell",image:"thorium4",income:270000,heat:810000,power:240,capacity:0,pulses:4,pulse:0,sell:0,tier:3,id:10,name:"thorium4",replacecost:21600000}},
        {name:"thorium8",gname:"Octo Thorium Cell ($50.4M)",cost:50400000,default:{type:"cell",image:"thorium8",income:720000,heat:2880000,power:240,capacity:0,pulses:8,pulse:0,sell:0,tier:3,id:11,name:"thorium8",replacecost:50400000}},
        {name:"seaborgium1",gname:"Seaborgium Cell ($2160M)",cost:2160000000,default:{type:"cell",image:"seaborgium1",income:3375000,heat:3375000,power:960,capacity:0,pulses:1,pulse:0,sell:0,tier:4,id:12,name:"seaborgium1",replacecost:2160000000}},
        {name:"seaborgium2",gname:"Dual Seaborgium Cell ($5400M)",cost:5400000000,default:{type:"cell",image:"seaborgium2",income:13500000,heat:27000000,power:960,capacity:0,pulses:2,pulse:0,sell:0,tier:4,id:13,name:"seaborgium2",replacecost:5400000000}},
        {name:"seaborgium4",gname:"Quad Seaborgium Cell ($12.96B)",cost:12960000000,default:{type:"cell",image:"seaborgium4",income:40500000,heat:121500000,power:960,capacity:0,pulses:4,pulse:0,sell:0,tier:4,id:14,name:"seaborgium4",replacecost:12960000000}},
        {name:"seaborgium8",gname:"Octo Seaborgium Cell ($30.24B)",cost:30240000000,default:{type:"cell",image:"seaborgium8",income:108000000,heat:432000000,power:960,capacity:0,pulses:8,pulse:0,sell:0,tier:4,id:15,name:"seaborgium8",replacecost:30240000000}},
        {name:"dolorium1",gname:"Dolorium Cell ($1296B)",cost:1296000000000,default:{type:"cell",image:"dolorium1",income:506250000,heat:506250000,power:3840,capacity:0,pulses:1,pulse:0,sell:0,tier:5,id:16,name:"dolorium1",replacecost:1296000000000}},
        {name:"dolorium2",gname:"Dual Dolorium Cell ($3240B)",cost:3240000000000,default:{type:"cell",image:"dolorium2",income:2025000000,heat:4050000000,power:3840,capacity:0,pulses:2,pulse:0,sell:0,tier:5,id:17,name:"dolorium2",replacecost:3240000000000}},
        {name:"dolorium4",gname:"Quad Dolorium Cell ($7776B)",cost:7776000000000,default:{type:"cell",image:"dolorium4",income:6075000000,heat:18225000000,power:3840,capacity:0,pulses:4,pulse:0,sell:0,tier:5,id:18,name:"dolorium4",replacecost:7776000000000}},
        {name:"dolorium8",gname:"Octo Dolorium Cell ($18.14T)",cost:18144000000000,default:{type:"cell",image:"dolorium8",income:16200000000,heat:64800000000,power:3840,capacity:0,pulses:8,pulse:0,sell:0,tier:5,id:19,name:"dolorium8",replacecost:18144000000000}},
        {name:"nefastium1",gname:"Nefastium Cell ($777.6T)",cost:777600000000000,default:{type:"cell",image:"nefastium1",income:75937500000,heat:75937500000,power:15360,capacity:0,pulses:1,pulse:0,sell:0,tier:6,id:20,name:"nefastium1",replacecost:777600000000000}},
        {name:"nefastium2",gname:"Dual Nefastium Cell ($1944T)",cost:1944000000000000,default:{type:"cell",image:"nefastium2",income:303750000000,heat:607500000000,power:15360,capacity:0,pulses:2,pulse:0,sell:0,tier:6,id:21,name:"nefastium2",replacecost:1944000000000000}},
        {name:"nefastium4",gname:"Quad Nefastium Cell ($4666T)",cost:4665600000000000,default:{type:"cell",image:"nefastium4",income:911250000000,heat:2733750000000,power:15360,capacity:0,pulses:4,pulse:0,sell:0,tier:6,id:22,name:"nefastium4",replacecost:4665600000000000}},
        {name:"nefastium8",gname:"Octo Nefastium Cell ($10.89Qa)",cost:10886400000000000,default:{type:"cell",image:"nefastium8",income:2430000000000,heat:9720000000000,power:15360,capacity:0,pulses:8,pulse:0,sell:0,tier:6,id:23,name:"nefastium8",replacecost:10886400000000000}}
        ],[
        {name:"protium1",gname:"Protium Cell ($3840T)",cost:3840000000000000,unlock:0,default:{type:"cell",image:"protium1",income:4000000000000,heat:4000000000000,power:960,capacity:0,pulses:1,pulse:0,sell:0,tier:7,id:24,name:"protium1",replacecost:3840000000000000,unlock:0}},
        {name:"protium2",gname:"Dual Protium Cell ($9600T)",cost:9600000000000000,unlock:0,default:{type:"cell",image:"protium2",income:8000000000000,heat:16000000000000,power:960,capacity:0,pulses:2,pulse:0,sell:0,tier:7,id:25,name:"protium2",replacecost:9600000000000000,unlock:0}},
        {name:"protium4",gname:"Quad Protium Cell ($23.04Qa)",cost:23040000000000000,unlock:0,default:{type:"cell",image:"protium4",income:48000000000000,heat:144000000000000,power:960,capacity:0,pulses:4,pulse:0,sell:0,tier:7,id:26,name:"protium4",replacecost:23040000000000000,unlock:0}},
        {name:"protium8",gname:"Octo Protium Cell ($53.76Qa)",cost:53760000000000000,unlock:0,default:{type:"cell",image:"protium8",income:128000000000000,heat:512000000000000,power:960,capacity:0,pulses:4,pulse:0,sell:0,tier:7,id:27,name:"protium8",replacecost:53760000000000000,unlock:0}}
        ],[
        {name:"vent1",gname:"Basic Vent ($50)",cost:50,default:{type:"vent",image:"vent1",capacity:40,vent:4,heat:0,sell:50,tier:1}},
        {name:"vent2",gname:"Advanced Vent ($12.5K)",cost:12500,default:{type:"vent",image:"vent2",capacity:3000,vent:300,heat:0,sell:12500,tier:2}},
        {name:"vent3",gname:"Super Vent ($3125K)",cost:3125000,default:{type:"vent",image:"vent3",capacity:225000,vent:22500,heat:0,sell:3125000,tier:3}},
        {name:"vent4",gname:"Wondrous Vent ($781.3M)",cost:781250000,default:{type:"vent",image:"vent4",capacity:16875000,vent:1687500,heat:0,sell:781250000,tier:4}},
        {name:"vent5",gname:"Ultimate Vent ($195.3B)",cost:195312500000,default:{type:"vent",image:"vent5",capacity:1265625000,vent:126562500,heat:0,sell:195312500000,tier:5}},
        ],[
        {name:"outlet1",gname:"Basic Outlet ($160)",cost:160,default:{type:"outlet",image:"outlet1",out:4,capacity:0,sell:160,tier:1}},
        {name:"outlet2",gname:"Advanced Outlet ($32K)",cost:32000,default:{type:"outlet",image:"outlet2",out:300,capacity:0,sell:32000,tier:2}},
        {name:"outlet3",gname:"Super Outlet ($6400K)",cost:6400000,default:{type:"outlet",image:"outlet3",out:22500,capacity:0,sell:6400000,tier:3}},
        {name:"outlet4",gname:"Wondrous Outlet ($1280M)",cost:1280000000,default:{type:"outlet",image:"outlet4",out:1687500,capacity:0,sell:1280000000,tier:4}},
        {name:"outlet5",gname:"Ultimate Outlet ($256B)",cost:256000000000,default:{type:"outlet",image:"outlet5",out:126562500,capacity:0,sell:256000000000,tier:5}},
        {name:"inlet1",gname:"Basic Inlet ($160)",cost:160,default:{type:"inlet",image:"inlet1",in:4,capacity:0,sell:160,tier:1}},
        {name:"inlet2",gname:"Advanced Inlet ($32K)",cost:32000,default:{type:"inlet",image:"inlet2",in:300,capacity:0,sell:32000,tier:2}},
        {name:"inlet3",gname:"Super Inlet ($6400K)",cost:6400000,default:{type:"inlet",image:"inlet3",in:22500,capacity:0,sell:6400000,tier:3}},
        {name:"inlet4",gname:"Wondrous Inlet ($1280M)",cost:1280000000,default:{type:"inlet",image:"inlet4",in:1687500,capacity:0,sell:1280000000,tier:4}},
        {name:"inlet5",gname:"Ultimate Inlet ($256B)",cost:256000000000,default:{type:"inlet",image:"inlet5",in:126562500,capacity:0,sell:256000000000,tier:5}}
        ],[
        {name:"cap1",gname:"Basic Capacitor ($1000)",cost:1000,default:{type:"capacitor",image:"cap1",power:100,capacity:10,heat:0,sell:1000,tier:1}},
        {name:"cap2",gname:"Advanced Capacitor ($160K)",cost:160000,default:{type:"capacitor",image:"cap2",power:14000,capacity:50,heat:0,sell:160000,tier:2}},
        {name:"cap3",gname:"Super Capacitor ($25.6M)",cost:25600000,default:{type:"capacitor",image:"cap3",power:1960000,capacity:250,heat:0,sell:25600000,tier:3}},
        {name:"cap4",gname:"Wondrous Capacitor ($4096M)",cost:4096000000,default:{type:"capacitor",image:"cap4",power:2744000000,capacity:1250,heat:0,sell:4096000000,tier:4}},
        {name:"cap5",gname:"Ultimate Capacitor ($655.4B)",cost:655360000000,default:{type:"capacitor",image:"cap5",power:384160000000,capacity:6250,heat:0,sell:655360000000,tier:5}}
        ],[
        {name:"plating1",gname:"Basic Plating ($1000)",cost:1000,default:{type:"plating",image:"plating1",heat:100,sell:1000,tier:1}},
        {name:"plating2",gname:"Advanced Plating ($160K)",cost:160000,default:{type:"plating",image:"plating2",heat:14000,sell:160000,tier:2}},
        {name:"plating3",gname:"Super Plating ($25.6M)",cost:25600000,default:{type:"plating",image:"plating3",heat:1960000,sell:160000,tier:3}},
        {name:"plating4",gname:"Wondrous Plating ($4096M)",cost:4096000000,default:{type:"plating",image:"plating4",heat:2744000000,sell:4096000000,tier:4}},
        {name:"plating5",gname:"Ultimate Plating ($655.4B)",cost:655360000000,default:{type:"plating",image:"plating5",heat:384160000000,sell:655360000000,tier:5}}
        ],[
        {name:"cool1",gname:"Basic Coolant Cell ($500)",cost:5000,default:{type:"coolant",image:"cool1",capacity:2000,heat:0,sell:500,tier:1}},
        {name:"cool2",gname:"Advanced Coolant Cell ($100K)",cost:100000,default:{type:"coolant",image:"cool2",capacity:100000,heat:0,sell:100000,tier:2}},
        {name:"cool3",gname:"Super Coolant Cell ($20M)",cost:20000000,default:{type:"coolant",image:"cool3",capacity:5000000,heat:0,sell:20000000,tier:3}},
        {name:"cool4",gname:"Wondrous Coolant Cell ($4000M)",cost:4000000000,default:{type:"coolant",image:"cool4",capacity:250000000,heat:0,sell:4000000000,tier:4}},
        {name:"cool4",gname:"Ultimate Coolant Cell ($800B)",cost:800000000000,default:{type:"coolant",image:"cool4",capacity:12500000000,heat:0,sell:800000000000,tier:5}}
        ],[
        {name:"accel1",gname:"Basic Particle Accelerator ($1000B)",cost:1000000000000,default:{type:"accelerator",image:"accel1",maxheat:500000000,maxep:0.02,capacity:100,heat:0,sell:1000000000000,tier:1}},
        {name:"accel2",gname:"Advanced Particle Accelerator ($1000Qa)",cost:1000000000000000000,default:{type:"accelerator",image:"accel1",maxheat:500000000000000,maxep:2,capacity:100000000,heat:0,sell:1000000000000000000,tier:2}},
        ]]
        window.upgrades={potent:[0,0,0,0,0,0],perpetual:[0,0,0,0,0,0],generic:[0,0,0,0,0],ep:[0,0,0,0],unlock:[0]}
        window.reactor=[]
        window.cellmetas=[1] //protium bonus
        for(var i=0;i<=canvas.width/30;i++){
            reactor.push([])
            for(var j=0;j<=canvas.width/30;j++){
                reactor[reactor.length-1].push({type:"empty",explosion:0})
            }
        }
    }
    if(tier>2){ //restart game
        window.aep=0
        window.sep=0
        window.tooltips={
        cell:cellTooltip,
        vent:function(vent){return "Vents "+format(ventHeat(vent))+" heat per tick. Holds "+format(heatCap(vent))+" heat."},
        capacitor:function(cap){return "Holds "+format(cap.power*(upgrades.generic[3]+1))+" power and "+format(cap.capacity)+" heat."},
        outlet:function(out){return "Adds "+format(IOletHeat(out.out))+" heat to adjacent components."},
        inlet:function(inlet){return "Removes "+format(IOletHeat(inlet.in))+" heat from adjacent components."},
        plating:function(plate){return "Adds "+format(plate.heat)+" heat capacity to your reactor."},
        coolant:function(cool){return "Stores "+format(cool.capacity)+" heat."},
        accelerator:function(accel){return "Generates Exotic Particles based on heat passing through it. Maximum "+format(accel.maxheat)+" heat for generation. Stores "+format(accel.capacity)+" heat."}
        }
        window.types=["Cells","Exotic Cells","Vents","In/Outlets","Capacitors","Plating","Coolant Cells","Particle Accelerators"]
        window.itemstable={
        uranium1:0,uranium2:1,uranium4:2,uranium8:3,
        plutonium1:4,plutonium2:5,plutonium4:6,plutonium8:7,
        thorium1:8,thorium2:9,thorium4:10,thorium8:11,
        seaborgium1:12,seaborgium2:13,seaborgium4:14,seaborgium8:15,
        dolorium1:16,dolorium2:17,dolorium4:18,dolorium8:19,
        nefastium1:20,nefastium2:21,nefastium4:22,nefastium8:23,
        protium1:24,protium2:25,protium4:26,protium8:27} //oh yeah that
        window.cellcosts=[10,6000,3600000,2160000000,1296000000000,777600000000000]
        window.genericcosts=[100,250,600,1000,1000] //powerlines,vents,ioutlets,wiring,active
        window.epcosts=[100,50,50,50] //unleashed,infused,hyperdynamics,piping
        window.unlockcosts=[50]
    }
}
function drawGrid(){
    context.beginPath()
    for(var i=30;i<canvas.width;i+=30){
        context.moveTo(i,0)
        context.lineTo(i,canvas.height)
    }
    for(var i=30;i<canvas.height;i+=30){
        context.moveTo(0,i)
        context.lineTo(canvas.width,i)
    }
}
function loadImages(){
    var images=["uranium1","uranium1d","uranium2","uranium2d","uranium4","uranium4d","uranium8","uranium8d","plutonium1","plutonium1d","plutonium2","plutonium2d","plutonium4","plutonium4d","plutonium8","plutonium8d","thorium1","thorium1d","thorium2","thorium2d","thorium4","thorium4d","thorium8","thorium8d","seaborgium1","seaborgium1d","seaborgium2","seaborgium2d","seaborgium4","seaborgium4d","seaborgium8","seaborgium8d","dolorium1","dolorium1d","dolorium2","dolorium2d","dolorium4","dolorium4d","dolorium8","dolorium8d","nefastium1","nefastium1d","nefastium2","nefastium2d","nefastium4","nefastium4d","nefastium8","nefastium8d","protium1","protium1d","protium2","protium2d","protium4","protium4d","protium8","protium8d","vent1","vent2","vent3","vent4","vent5","outlet1","outlet2","outlet3","outlet4","outlet5","inlet1","inlet2","inlet3","inlet4","inlet5","cap1","cap2","cap3","cap4","cap5","plating1","plating2","plating3","plating4","plating5","cool1","cool2","cool3","cool4","cool5","accel1","boom"]
    for(var i=0;i<images.length;i++){
        window[images[i]+"img"]=new Image()
        window[images[i]+"img"].src="./"+images[i]+".png"
    }
}
function cellPower(cell){
    if(cell.tier<7){
        return cell.income*(upgrades.potent[cell.tier-1]+1)*(upgrades.ep[1]+1)*Math.pow(2,upgrades.ep[0])
    }else{
        var base=cell.income*(upgrades.ep[1]+1)*Math.pow(2,upgrades.ep[0])
        if(cell.tier==7){
            base*=cellmetas[0]
        }
        return base
    }
}
function cellHeat(cell){
    return cell.heat*Math.pow(2,upgrades.ep[0])
}
function ventHeat(vent){
    return vent.vent*(upgrades.generic[1]+1)*(1+capboost/100*upgrades.generic[4])*Math.pow(2,upgrades.ep[2])
}
function heatCap(cell){
    if(cell.type=="vent"){
        return cell.capacity*Math.pow(2,upgrades.ep[2])
    }else{
        return cell.capacity
    }
}
function IOletHeat(strength){
    return strength*(upgrades.generic[2]+1)*(1+capboost/100*upgrades.generic[4])*Math.pow(2,upgrades.ep[3])
}
function cellTooltip(cell){
    if(cell.tier<7||upgrades.unlock[cell.unlock]){
        str="Generates "+format(cellPower(cell))+" power and "+format(cellHeat(cell))+" heat per tick for "+format(cell.power)+" ticks."
        if(cell.tier>=7){
            str+=" "
            str+=["Power output increases every time a Protium cell expries."][cell.tier-7]
        }
        return str
    }else{
        return "Locked"
    }
}
function buyitem(object,x,y,gridx,gridy){
    if(bux>=object.cost&&unlocked(object)){
        sellitem(gridx,gridy)
        reactor[gridx][gridy]=Object.assign({drawx:x,drawy:y},object.default)
        tracker.boughtitem++
        if(object.default.type=="vent"){tracker.boughtvent++}
        if(object.default.type=="cell"){tracker.maxcelltier=Math.max(object.default.tier,tracker.maxcelltier)}
        updateBux(-object.cost)
        updateAll()
    }
}
function unlocked(object){
    return typeof object.unlock=="undefined"||upgrades.unlock[object.unlock]
}
function sellitem(x,y){
    if(reactor[x][y].type!="empty"){
        updateBux(reactor[x][y].sell)
        reactor[x][y]={type:"empty",explosion:0}
    }
}
function click(event){
    if(event.shiftKey){
        replaceall(event)
    }else{
        mode(event)
    }
} 
function rclick(event){
    if(event.shiftKey){
        sellall(event)
    }else{
        sell(event)
    }
    return false
}
function buy(event){
    var x=event.pageX-canvasleft
    var y=event.pageY-canvastop
    var ioffset=18
    var ooffset=3
    var scale=30
    x=(x-ioffset)/scale;y=(y-ioffset)/scale
    x=Math.round(x);y=Math.round(y)
    gridx=x;gridy=y
    x=x*scale+ooffset;y=y*scale+ooffset
    var object=currentItem()
    var cell=reactor[gridx][gridy]
    switch(cell.type){
        case "empty":
            buyitem(object,x,y,gridx,gridy)
            break;
        case "dcell":
            buyitem(items[0][itemstable[cell.name]],x,y,gridx,gridy)
            break;
        default:
            if(object.default.type==cell.type){
                buyitem(object,x,y,gridx,gridy)
            }
            break;
    }
}
function replaceall(event){
    var x=event.pageX-canvasleft
    var y=event.pageY-canvastop
    var ioffset=18
    var ooffset=3
    var scale=30
    x=(x-ioffset)/scale;y=(y-ioffset)/scale
    x=Math.round(x);y=Math.round(y)
    gridx=x;gridy=y
    x=x*scale+ooffset;y=y*scale+ooffset
    var image=reactor[gridx][gridy].image
    for(var i=0;i<reactor.length;i++){
        for(var j=0;j<reactor[i].length;j++){
            var cell=reactor[i][j]
            if(cell.image==image&&cell.type=="dcell"&&options[0]){
                buyitem(items[0][itemstable[cell.name]],cell.drawx,cell.drawy,i,j)
            }else if(cell.image==image&&cell.type!="empty"&&(options[1]||currentItem().default.type==reactor[gridx][gridy].type)){
                buyitem(currentItem(),cell.drawx,cell.drawy,i,j)
            }
        }
    }
}
function sell(event){
    var x=event.pageX-canvasleft
    var y=event.pageY-canvastop
    var ioffset=18
    var ooffset=3
    var scale=30
    x=(x-ioffset)/scale;y=(y-ioffset)/scale
    x=Math.round(x);y=Math.round(y)
    gridx=x;gridy=y
    x=x*scale+ooffset;y=y*scale+ooffset
    var cell=reactor[gridx][gridy]
    if(cell.type!="empty"){
        sellitem(gridx,gridy)
    }
}

function sellall(event){
    var x=event.pageX-canvasleft
    var y=event.pageY-canvastop
    var ioffset=18
    var ooffset=3
    var scale=30
    x=(x-ioffset)/scale;y=(y-ioffset)/scale
    x=Math.round(x);y=Math.round(y)
    gridx=x;gridy=y
    x=x*scale+ooffset;y=y*scale+ooffset
    var image=reactor[gridx][gridy].image
    for(var i=0;i<reactor.length;i++){
        for(var j=0;j<reactor[i].length;j++){
            if(reactor[i][j].image==image){
                sellitem(i,j)
            }
        }
    }
}
function clickmode(button){
    for(i=0;i<4;i++){
        document.getElementById("mode"+i).disabled=false
    }
    document.getElementById("mode"+button).disabled=true
}
function sellpower(){
    updateBux(power)
    updatePower(-power)
    tracker.soldpower++
}
function nextItem(){
    item+=1
    item%=items[type].length
    updateItem(item)
}
function prevItem(){
    if(!item){item=items[type].length}
    item-=1
    updateItem(item)
}
function nextType(){
    selector[type]=item
    type+=1
    type%=types.length
    item=selector[type]
    updateType(type)
}
function prevType(){
    selector[type]=item
    if(!type){type=types.length}
    type-=1
    item=selector[type]
    updateType(type)
}
function togglePerpetual(){
    perpetual=!perpetual
    if(perpetual){
        update("perpetual","Disable perpetual cells")
    }else{
        update("perpetual","Enable perpetual cells")
    }
}
function togglePause(){
    if(!run){
        unpause()
    }else{
        pause()
    }
}
function pause(){
    run=false
    update("pause","Unpause")
}
function unpause(){
    run=true
    update("pause","Pause")
}
function income(){
    buxpertick=0
    context.clearRect(0, 0, canvas.width, canvas.height)
    if(run){
        for(var i=0;i<reactor.length;i++){ //pulses tick
            for(var j=0;j<reactor[i].length;j++){
                cell=reactor[i][j]
                switch(cell.type){
                    case "cell":
                        addpulse(i,j,cell.pulses)
                        break;
                    default:
                        break;
                }
            }
        }
        for(var i=0;i<reactor.length;i++){ //cell heat tick
            for(var j=0;j<reactor[i].length;j++){
                cell=reactor[i][j]
                switch(cell.type){
                    case "cell":
                        console.log(cell.heat)
                        addheat(i,j,cellHeat(cell)*Math.pow(cell.pulse+1,2),false)
                        break;
                    default:
                        break;
                }
            }
       }
        for(var i=0;i<reactor.length;i++){ //accelerator tick
            for(var j=0;j<reactor[i].length;j++){
                cell=reactor[i][j]
                switch(cell.type){
                    case "accelerator":
                        console.log(cell.heat)
                        updateEP(cell.heat/cell.maxheat*cell.maxep)
                        break;
                    default:
                        break;
                }
            }
        }
        for(var i=0;i<reactor.length;i++){ //inlet tick
            for(var j=0;j<reactor[i].length;j++){
                cell=reactor[i][j]
                switch(cell.type){
                    case "inlet":
                        heat+=removeheat(i,j,IOletHeat(cell.in),true)
                        break;
                    default:
                        break;
                }
            }
        }
        for(var i=0;i<reactor.length;i++){ //outlet tick
            for(var j=0;j<reactor[i].length;j++){
                cell=reactor[i][j]
                switch(cell.type){
                    case "outlet":
                        addheat(i,j,Math.min(IOletHeat(cell.out),heat),true)
                        heat-=Math.min(IOletHeat(cell.out),heat)
                        break;
                    default:
                        break;
                }
            }
        }
        for(var i=0;i<reactor.length;i++){ //vent tick
            for(var j=0;j<reactor[i].length;j++){
                cell=reactor[i][j]
                switch(cell.type){
                    case "vent":
                        cell.heat-=ventHeat(cell)
                        if(cell.heat<0){cell.heat=0}
                        break;
                    default:
                        break;
                }
            }
        }
        for(var i=0;i<reactor.length;i++){ //action tick
            for(var j=0;j<reactor[i].length;j++){
                cell=reactor[i][j]
                switch(cell.type){
                    case "empty":
                        if(cell.explosion>0){reactor[i][j].explosion--;context.drawImage(boomimg,cell.drawx,cell.drawy)}
                    break;
                    case "cell":
                        context.drawImage(window[cell.image+"img"],cell.drawx,cell.drawy)
                        buxpertick+=cellPower(cell)*(cell.pulse+1)
                        cell.pulse=0
                        cell.power--
                        if(!cell.power){
                            cell.type="dcell";cell.image+="d"
                            if(cell.tier<upgrades.perpetual.length&&upgrades.perpetual[cell.tier-1]&&perpetual){
                                var subtables=[-1,0,0,0,0,0,0,1,1,1,1,1,1] //if i ever add perpetual ep cells
                                buyitem(items[subtables[cell.tier]][itemstable[cell.name]],cell.drawx,cell.drawy,i,j)
                            }
                            if(cell.tier==7){
                                cellmetas[0]+=0.05*cell.pulses
                            }
                        }
                        break;
                    default:
                        context.drawImage(window[cell.image+"img"],cell.drawx,cell.drawy)
                        if(cell.capacity&&cell.heat>heatCap(cell)){
                            reactor[i][j]={type:"empty",explosion:4,drawx:cell.drawx,drawy:cell.drawy}
                        }
                        break;
                }
                if(heat>maxheat*2&&cell.type!="empty"||!unlocked(cell)){
                    reactor[i][j]={type:"empty",explosion:4,drawx:cell.drawx,drawy:cell.drawy}}
            }
        }
        updateBux(Math.min(autosell,power))
        updatePower(-Math.min(autosell,power))
        updateHeat(Math.min((maxheat-heat)/50,maxheat*-0.0001))
    }
    maxpower=100
    maxheat=1000
    capboost=0
    for(var i=0;i<reactor.length;i++){ //render/capacity tick
        for(var j=0;j<reactor[i].length;j++){
            cell=reactor[i][j]
            if(cell.type!="empty"){
                context.drawImage(window[cell.image+"img"],cell.drawx,cell.drawy)
            }
            if(cell.type=="capacitor"){
                maxpower+=cell.power*(upgrades.generic[3]+1)
                capboost+=cell.tier
            }
            if(cell.type=="plating"){
                maxheat+=cell.heat
            }
        }
    }
    drawGrid()
    context.stroke()
    updatePower(buxpertick)
    window.autosell=maxpower/100*upgrades.generic[0]
    checkObjectives()
}
function update(thing,value){
    document.getElementById(thing).innerHTML=value
}
function updateBux(amount){
    bux+=amount
    update("bux","Money: $"+format(bux))
}
function updatePower(amount){
    power+=amount
    if(power>maxpower){power=maxpower}
    update("power","Power: "+format(power)+"/"+format(maxpower))
}
function updateHeat(amount){
    heat+=amount
    clampheat()
    if(heat<0.1&&tracker.soldpower){tracker.zeroheat++}
    update("heat","Heat: "+format(heat)+"/"+format(maxheat))
}
function updateEP(amount){
    ep+=amount
    update("ep","EP: "+format(aep-sep)+"/"+format(aep)+", "+format(ep))
}
function spendEP(amount){
    sep-=amount
    update("ep","EP: "+format(aep-sep)+"/"+format(aep)+", "+format(ep))
}
function updateItem(item){
    update("item",currentItem().gname)
    update("tooltip",tooltips[currentItem().default.type].call(null,currentItem().default))
}
function updateType(type){
    update("type",types[type])
    updateItem(item)
}
function updateAll(){
    updatePower(0)
    updateHeat(0)
    updateBux(0)
    updateEP(0)
    updateItem(item)
    updateType(type)
}
function updateTrulyAll(){
    updateAll()
    for(var i=0;i<upgrades.potent.length;i++){
        update("potent"+i,"$"+format(cellcosts[i]*50*Math.pow(10,upgrades.potent[i])))
        update("potent"+i+"v",upgrades.potent[i])
    }
    for(var i=0;i<upgrades.perpetual.length;i++){
        update("perpetual"+i,upgrades.perpetual[i]?"Purchased":"$"+format(cellcosts[i]*100))
        update("perpetual"+i+"v",upgrades.perpetual[i])
    }
    for(var i=0;i<upgrades.generic.length;i++){
        update("generic"+i,"$"+format(genericcosts[i]*Math.pow(10,upgrades.generic[i])))
        update("generic"+i+"v",upgrades.generic[i])
    }
    for(var i=0;i<options.length;i++){
        update("options"+i,options[i]?"Yes":"No")
    }
    update("objective",objectives[objective])
}
function currentItem(){
    return items[type][item]
}
function addheat(x,y,heat,peritem){
    var cells=[]
    if(x>0){cells.push(reactor[x-1][y])}
    if(y>0){cells.push(reactor[x][y-1])}
    if(x<reactor.length-1){cells.push(reactor[x+1][y])}
    if(y<reactor[0].length-1){cells.push(reactor[x][y+1])}
    var heatcells=[]
    for(var i=0;i<cells.length;i++){
        if(cells[i].capacity>0){heatcells.push(cells[i])}
    }
    if(heatcells.length){
        for(var i=0;i<heatcells.length;i++){
            heatcells[i].heat+=(peritem?heat:heat/heatcells.length)
        }
    }else{
        updateHeat(heat)
    }
}
function addpulse(x,y,heat){
    var cells=[]
    if(x>0){cells.push(reactor[x-1][y])}
    if(y>0){cells.push(reactor[x][y-1])}
    if(x<reactor.length-1){cells.push(reactor[x+1][y])}
    if(y<reactor[0].length-1){cells.push(reactor[x][y+1])}
    var heatcells=[]
    for(var i=0;i<cells.length;i++){
        if(cells[i].type=="cell"){heatcells.push(cells[i])}
    }
    if(heatcells.length){
        for(var i=0;i<heatcells.length;i++){
            heatcells[i].pulse+=heat
        }
    }else{
        //...nothing? k
    }
}
function removeheat(x,y,maxheat,peritem){
    var cells=[]
    if(x>0){cells.push(reactor[x-1][y])}
    if(y>0){cells.push(reactor[x][y-1])}
    if(x<reactor.length-1){cells.push(reactor[x+1][y])}
    if(y<reactor[0].length-1){cells.push(reactor[x][y+1])}
    var heatcells=[]
    for(var i=0;i<cells.length;i++){
        if(cells[i].capacity>0){heatcells.push(cells[i])}
    }
    if(heatcells.length){
        var pullheat=0
        for(i=0;i<heatcells.length;i++){
            pullheat+=Math.min(heatcells[i].heat,maxheat)
            heatcells[i].heat-=Math.min(heatcells[i].heat,peritem?maxheat:maxheat/heatcells.length)
        }
    }else{
        var pullheat=0
    }
    return pullheat
}
function clampheat(){
    if(heat<0){heat=0}
    heat=Math.round(heat*10)/10
}
function buyPotent(tier){
    if(bux>=cellcosts[tier]*50*Math.pow(10,upgrades.potent[tier])){
        tracker.upgraded++
        updateBux(-(cellcosts[tier]*50*Math.pow(10,upgrades.potent[tier])))
        upgrades.potent[tier]++
        update("potent"+tier,"$"+format(cellcosts[tier]*50*Math.pow(10,upgrades.potent[tier])))
        update("potent"+tier+"v",upgrades.potent[tier])
    }
}
function buyPerpetual(tier){
    if(bux>=cellcosts[tier]*100&&!upgrades.perpetual[tier]){
        tracker.upgraded++
        tracker.perpetual++
        updateBux(-(cellcosts[tier]*100))
        upgrades.perpetual[tier]++
        update("perpetual"+tier,"Purchased")
        update("perpetual"+tier+"v",upgrades.perpetual[tier])
    }
}
function buyGeneric(upgrade){
    if(bux>=genericcosts[upgrade]*Math.pow(10,upgrades.generic[upgrade])){
        tracker.upgraded++
        updateBux(-genericcosts[upgrade]*Math.pow(10,upgrades.generic[upgrade]))
        upgrades.generic[upgrade]++
        update("generic"+upgrade,"$"+format(genericcosts[upgrade]*Math.pow(10,upgrades.generic[upgrade])))
        update("generic"+upgrade+"v",upgrades.generic[upgrade])
    }
}
function buyEP(upgrade){
    if(aep-sep>=epcosts[upgrade]*Math.pow(2,upgrades.ep[upgrade])){
        tracker.upgraded++
        spendEP(-epcosts[upgrade]*Math.pow(10,upgrades.ep[upgrade]))
        upgrades.ep[upgrade]++
        update("ep"+upgrade,format(epcosts[upgrade]*Math.pow(2,upgrades.ep[upgrade]))+" EP")
        update("ep"+upgrade+"v",upgrades.ep[upgrade])
    }
}
function buyCellType(tier){
    if(aep-sep>=unlockcosts[tier]&&!upgrades.unlock[tier]){
        tracker.upgraded++
        spendEP(-unlockcosts[tier])
        upgrades.unlock[tier]++
        update("unlock"+tier,"Purchased")
        update("unlock"+tier+"v",upgrades.unlock[tier])
    }
}
function checkObjectives(){
    var complete=false
    switch(objective){
        case 0: //case statements suck, they should be replaced >:(
            complete=tracker.maxcelltier
            break;
        case 1:
            complete=tracker.soldpower
            break;
        case 2:
            complete=tracker.zeroheat
            break;
        case 3:
            complete=tracker.boughtvent
            break;
        case 4:
            complete=tracker.upgraded
            break;
        case 5:
            complete=buxpertick>50
            break;
        case 6:
            complete=tracker.perpetual
            break;
        case 7:
            complete=buxpertick>200
            break;
        case 8:
            complete=tracker.maxcelltier>1
            break;
        case 9:
            complete=buxpertick>1000
            break;
        case 10:
            complete=upgrades.generic[1]>2
            break;
        case 11:
            complete=Math.min(autosell,buxpertick)>1000
            break;
        case 12:
            complete=tracker.maxcelltier>2
            break;
        default:
            complete=false //maybe later :D
            break;
    }
    if(complete){
        updateBux(rewards[objective])
        objective++
        update("objective",objectives[objective])
    }
    return complete
}
function checkFor(image){
    for(var i=0;i<reactor.length;i++){
        for(var j=0;j<reactor.length;j++){
            if(reactor[i][j].image==image){return true}
        }
    }
    return false;
}
function format(n){
    if(!exactplz){
        var norder=Math.max(Math.floor((Math.log10(n)-1)/3),0)
        if(norder){
            return (n/Math.pow(1000,norder)).toPrecision(4)+modifier(norder)
        }else{
            return Math.round(n*10000)/10000
        }
    }else{return n}
}
function modifier(n){
    var modifiers=["K","M","B","T","Qa","Qi","Sx","Sp","Oc","No"]
    var xmodifiers=["Dc","Vg","Tg","Qg","Pg","Sg","Hg","Og","Ng","Ct"] //this is enough, trust me
    var smodifiers=["","U","D","T","Q","P","S","H","O","N"]
    if(n<=10){
        return modifiers[n-1]
    }else{
        n--
        return smodifiers[n%10]+xmodifiers[Math.floor(n/10)-1]
    }
}
function formattest(){
    for(i=0;i<308;i+=3){
        console.log(format(Math.pow(10,i)))
    }
}
function savefile(){
    return document.getElementById("savefile").value
}
function setsavefile(x){
    document.getElementById("savefile").value=x
}
function save(){
    var saveobject={version:[0,6,0,2],bux:bux,power:power,heat:heat,ep:ep,aep:aep,sep:sep,maxpower:maxpower,maxheat:maxheat,objective:objective,options:options,tracker:tracker,upgrades:upgrades,reactor:reactor}
    setsavefile(JSON.stringify(saveobject))
    return JSON.stringify(saveobject)
}
function load(){
    var saveobject=JSON.parse(savefile())
    var load=["bux","power","heat","maxpower","maxheat","objective","options","upgrades","tracker","reactor","ep","aep","sep"]
    if(lorder(saveobject.version,[0,6,0,2])){
        setsavefile("Future version detected. Please use latest version of game.")
    }else{
        resetValues(3)
        for(var i=0;i<load.length;i++){
            if(load[i] in saveobject){window[load[i]]=pad(window[load[i]],saveobject[load[i]])}
        }
        pause()
        updateTrulyAll()
    }
}
function lorder(lt,gt){
    for(var i=0;i<lt.length;i++){
        if(lt[i]>gt[i]){return true}
        if(lt[i]<gt[i]){return false}
    }
}
function pad(x,y){
    if(typeof x=="number"){return y!==undefined?y:x}
    if(x.constructor==Array){return Object.assign(x,y)}
    var temp={}
    for(var i in x){
        temp[i]=Object.assign(x[i],y[i])
    }
    return temp
}
function setOption(x){
    options[x]=!options[x]
    update("options"+x,options[x]?"Yes":"No")
}
function reboot(){
    aep+=ep
    resetValues(2)
    updateTrulyAll()
}
</script>
</body></html>